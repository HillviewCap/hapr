# HAPR Security Baseline - HAProxy Audit Framework
# Version: 1.0.0
# Last Updated: 2025-05-01
#
# This file defines all security checks performed by the HAPR audit tool.
# Each check maps to industry standards (NIST SP 800-53, OWASP, DISA STIG).
#
# Check definitions are split into per-category files under checks/.
# The check_files list below references them in canonical order.

metadata:
  name: HAPR Security Baseline
  version: "1.0.0"
  description: >
    Comprehensive security baseline for HAProxy configurations.
    Covers process hardening, TLS, access control, headers, request handling,
    logging, information disclosure, timeouts, backend/frontend security,
    global settings, live TLS scanning, and known CVE detection.
  author: HAPR Project
  categories:
    - process
    - tls
    - access
    - headers
    - request
    - logging
    - disclosure
    - timeouts
    - backend
    - frontend
    - global_defaults
    - tls_live
    - cve
  severity_weights:
    critical: 10
    high: 7
    medium: 4
    low: 2
    info: 0
  tiers:
    baseline: "Minimum viable security - every deployment must pass"
    level1: "Standard production security"
    level2: "Enhanced security for sensitive environments"
    level3: "Maximum hardening for high-security environments"

check_files:
  - process.yaml
  - tls.yaml
  - access.yaml
  - headers.yaml
  - request.yaml
  - logging.yaml
  - disclosure.yaml
  - timeouts.yaml
  - backend.yaml
  - frontend.yaml
  - global_defaults.yaml
  - tls_live.yaml
  - cve.yaml
